Changes sugested for regression class

In SGD():
Change from prin=False to prin=None and add tol=None as an input.

Change the lines:

self.residual(X,y)
loss_[ep] = np.sum(self.loss)
info = "Epoch: {:}/{:} \t\t Loss: {:.3f}".format(ep+1, n_epochs, loss_[ep])
print(info)

to

self.residual(X,y)
loss_[ep] = np.sum(self.loss)

if prin:
    info = "Epoch: {:}/{:} \t\t Loss: {:.3f}".format(ep+1, n_epochs, loss_[ep])
    print(info)



    alida ~/Documents/uio/Master/FYS-STK4155/project2/code dev(*&?) # $ python run_gradient.py
    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  2
    Learn rate:  0.5
    Gamma:       None

    /home/alida/Documents/uio/Master/FYS-STK4155/project2/code/regression.py:47: RuntimeWarning: overflow encountered in square
      self.residual_sum_squares = sum(self.residuals**2)
    /home/alida/Documents/uio/Master/FYS-STK4155/project2/code/regression.py:543: RuntimeWarning: overflow encountered in matmul
      return (2.0/n)*X.T @ (X @ self.beta -  y)
    /home/alida/Documents/uio/Master/FYS-STK4155/project2/code/regression.py:543: RuntimeWarning: invalid value encountered in matmul
      return (2.0/n)*X.T @ (X @ self.beta -  y)
    gradient.py:30: RuntimeWarning: invalid value encountered in double_scalars
      loss = model.SGD(X_train, y_train, n_epochs=ep, batch_size=bs, learn_rate=lr, gamma=gm, prin=p)
    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
    r2 :  nan
    mse:  nan


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  5
    Learn rate:  0.5
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.70659124  0.03384067  0.40443095 -1.10828498  0.33119887 -1.88624623
      1.3591884   0.53635554 -0.15666996  1.28619541 -0.45254375 -0.46650047
      0.19048298 -0.25023341  0.03445811]
    r2 :  0.6810026248512626
    mse:  0.031267692327457575


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  10
    Learn rate:  0.5
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.73775965 -0.07017819  0.37560425 -0.71270332  0.33553941 -1.62693294
      0.65529872  0.42061976 -0.03937413  0.88866698 -0.17399222 -0.38128686
      0.24256757 -0.40585122  0.27255123]
    r2 :  0.7732254806804127
    mse:  0.022228132424242625


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  100
    Learn rate:  0.5
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.46201391 -0.57858568 -0.14783617  0.71856355 -0.15961478 -0.27425976
      0.7678771   0.73200754  0.12387084  1.12469426 -1.18738151 -0.53104096
      0.66512682 -0.99402286 -0.72709455]
    r2 :  0.09735768960782754
    mse:  0.08847578143841545


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  2
    Learn rate:  0.1
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.6952994   0.10495838  0.47663433 -1.33360757  0.36829465 -1.92395011
      1.44179071  0.57122926 -0.26341753  1.47850031 -0.50677343 -0.42246214
      0.2970673  -0.23320659  0.08731465]
    r2 :  -0.20589089392663018
    mse:  0.11819979845978332


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  5
    Learn rate:  0.1
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.74898846 -0.09927389  0.33915941 -0.64298254  0.34983017 -1.58126728
      0.62934571  0.4278387  -0.00976308  0.87574819 -0.17116376 -0.39695488
      0.242504   -0.43258715  0.26308246]
    r2 :  0.7780900210625644
    mse:  0.021751316739120792


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  10
    Learn rate:  0.1
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.86489201 -0.43758284 -0.01622966 -0.04411197  0.24875572 -1.02668402
      0.66787601  0.55028627  0.17160628  0.97128313 -0.51087449 -0.54562999
      0.36224016 -0.64070001 -0.11101306]
    r2 :  0.7414454134785569
    mse:  0.02534317173436307


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  100
    Learn rate:  0.1
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.06109803 -0.88966044  0.26848304  0.79119084 -0.1849217  -0.06203815
      0.91436729  0.81332796 -0.05579582  1.03492207 -1.0495522  -0.41553427
      0.60012371 -1.31534402 -1.04456506]
    r2 :  -1.5191898610177121
    mse:  0.24692759133840855


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  2
    Learn rate:  0.05
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.70680417  0.01753368  0.40252277 -0.95569132  0.33216926 -1.76289305
      0.97953454  0.48127772 -0.14238058  1.0756656  -0.29115863 -0.37635015
      0.23359138 -0.30854644  0.19283883]
    r2 :  0.7471708018513752
    mse:  0.024781976890634293


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  5
    Learn rate:  0.05
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.80972823 -0.26058962  0.17270736 -0.38204511  0.36000572 -1.34898881
      0.61613163  0.4791462   0.08852905  0.89801357 -0.27654768 -0.47481085
      0.26045838 -0.54075484  0.13142078]
    r2 :  0.7810032794586144
    mse:  0.02146576308164759


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  10
    Learn rate:  0.05
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.88551858 -0.55479875 -0.15700134  0.26348302  0.05963151 -0.73046512
      0.71688156  0.62004192  0.20156003  1.04781159 -0.77076975 -0.55632888
      0.51491164 -0.72623089 -0.34220162]
    r2 :  0.6422882040949123
    mse:  0.03506242761730403


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  100
    Learn rate:  0.05
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [-0.01034156 -1.00346934  0.39875613  0.80048351 -0.20563864 -0.01028813
      0.97843107  0.83050274 -0.11862087  1.00984319 -0.96060859 -0.37417289
      0.57437834 -1.41032606 -1.12196931]
    r2 :  -2.4946485689010522
    mse:  0.3425407378165397


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  2
    Learn rate:  0.001
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.81683564 -0.59550872 -0.22532545  0.48875162 -0.08964953 -0.51317774
      0.7400011   0.67804044  0.18759868  1.10371758 -0.98904651 -0.53801016
      0.6293428  -0.81615054 -0.50872154]
    r2 :  0.5066026957428555
    mse:  0.04836213808190774


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  5
    Learn rate:  0.001
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.24510144 -0.68831777  0.02587062  0.76684157 -0.16113713 -0.17175892
      0.81042156  0.77435385  0.04685931  1.08594181 -1.18191352 -0.48878968
      0.63753792 -1.14259226 -0.877235  ]
    r2 :  -0.33391198149706147
    mse:  0.13074825274004917


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  10
    Learn rate:  0.001
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.00742594 -0.97098359  0.36543362  0.79837776 -0.19832515 -0.02341774
      0.95859366  0.82657117 -0.10196355  1.0175235  -0.99017227 -0.38620965
      0.58039937 -1.38530798 -1.09986412]
    r2 :  -2.194225111255111
    mse:  0.3130936358231632


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  100
    Learn rate:  0.001
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.44315204 -0.23936829  0.63769031  1.44608511 -0.2378929  -0.20636751
      1.51959266  0.76989333 -0.4448239   0.58657834 -0.51006484 -0.45807825
      0.26770396 -1.87623594 -1.67271714]
    r2 :  -120.05096561666929
    mse:  11.865252330301635


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  2
    Learn rate:  0.0001
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.13755202 -0.79082727  0.15945333  0.78363611 -0.16979752 -0.11051137
      0.8625202   0.79816189 -0.00842436  1.0566754  -1.12120182 -0.44972761
      0.61717227 -1.23867611 -0.97246974]
    r2 :  -0.8802730263727527
    mse:  0.18430182521980998


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  5
    Learn rate:  0.0001
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [-7.93950757e-04 -1.00076494e+00  4.90492416e-01  8.50995989e-01
     -2.24138507e-01  4.58061151e-03  1.04687727e+00  8.25384832e-01
     -1.81233117e-01  9.68105427e-01 -8.87754390e-01 -3.70185164e-01
      5.28944499e-01 -1.49899703e+00 -1.19988002e+00]
    r2 :  -4.138019398744255
    mse:  0.503621729356038


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  10
    Learn rate:  0.0001
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.23964483 -0.60790792  0.59526991  1.16654394 -0.24301901 -0.10129436
      1.30314536  0.78685829 -0.34203924  0.75654829 -0.67934274 -0.4231369
      0.37300799 -1.72592057 -1.4696453 ]
    r2 :  -43.39305059799932
    mse:  4.351346925435644


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################

    Method:      OLS
    Lambda:      0.001 (Only if Ridge)
    Polydegree:  4
    Epochs:      100
    Batch size:  100
    Learn rate:  0.0001
    Gamma:       None

    Stochastic Gradient Descent
    -----------------------------------
    Beta :
    [ 0.49111226 -0.14889921  0.64665967  1.51492888 -0.23458048 -0.23122916
      1.57293166  0.76765726 -0.46693043  0.54715683 -0.46833604 -0.46495994
      0.24462274 -1.90943984 -1.71947207]
    r2 :  -144.47816982930058
    mse:  14.259573930548049


    Ordinary Least Squares:
    -----------------------------------
    Beta :
    [ 0.47669679  0.9904068   0.86453063 -4.79801571 -0.29719163 -3.62480225
      6.30180015  1.80337563 -0.03632782  3.89557823 -2.73952813 -1.1133977
      0.03261137 -0.26372802 -1.2275328 ]
    r2 :  0.8532929406408924
    mse:  0.014380028024267548

    #############################################################
