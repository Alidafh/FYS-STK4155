#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Configuration file for the classification CNN
"""
import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '3'
import tensorflow.python.util.deprecation as deprecation
deprecation._PRINT_DEPRECATION_WARNINGS = False
import tensorflow as tf
from generate import load_data
from tools import preprocess

###############################################################################
# Set up the data
###############################################################################
type = "classification"

path = "../data/"
filename = "data_(10000, 28, 28, 20)_1_0.008_0.0_0.0_10.0_1e+00_True_.npy"
#filename = "data_(10000, 28, 28, 20)_0.5_0.008_0.0_0.0_10.0_1e+00_True_.npy"
data_file = path+filename
slice = None

maps, labels, stats = load_data(file=data_file, slice=slice)

(X_train, y_train), (X_test, y_test) = preprocess(maps, labels,
                                                train_size = 0.8,
                                                regress=True,
                                                scale=True,
                                                seed=42,
                                                shuffle=True)


label_names = ["clean", "dm"]

###############################################################################
# for create_model()
###############################################################################
input_shape = (28, 28, 20)  # Shape of the images, holds the raw pixel values

n_filters = 16              # For the two first Conv2D layers
kernel_size = (5, 5)
layer_config = [32, 64]     # [layer1, layer2, layer3, ....] or None for no hidden layers
connected_neurons = 128     # For the first Dense layer

n_categories = 1            # For the last Dense layer (2 for GCE, 10 for mnist)

input_activation  = "relu"
hidden_activation = "relu"
output_activation = "sigmoid"

reg =  None #tf.keras.regularizers.l2(l=0.001)

###############################################################################
# for train_model()
###############################################################################
model_dir = "tmp/"           # Where to save the model

epochs = 100
batch_size = 10

opt = tf.keras.optimizers.Adam(learning_rate=1e-4)

reduce_lr = tf.keras.callbacks.ReduceLROnPlateau(monitor='val_loss', factor=0.01, patience=5, min_lr=1e-15)
early_stop = tf.keras.callbacks.EarlyStopping(monitor='val_loss', patience=20)

loss = "binary_crossentropy"
metrics = ["accuracy"]



(ML) [haharder@hepp01 code]$ python CNN.py -cn clas10_05
________________________________________________________________

Analysis: classification
Save as:  clas10_05
________________________________________________________________

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 28, 28, 16)        8016
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 14, 14, 16)        0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 14, 14, 32)        12832
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 7, 7, 32)          0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 7, 7, 64)          51264
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 3, 3, 64)          0
_________________________________________________________________
flatten (Flatten)            (None, 576)               0
_________________________________________________________________
dense (Dense)                (None, 128)               73856
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 129
=================================================================
Total params: 146,097
Trainable params: 146,097
Non-trainable params: 0
_________________________________________________________________

training: 6400 - validation: 1600 - Untrained, accuracy: 50.19%
_________________________________________________________________

Epoch 1/100
512/512 [==============================] - 4s 8ms/step - loss: 0.6936 - accuracy: 0.4998 - val_loss: 0.6929 - val_accuracy: 0.5125
Epoch 2/100
512/512 [==============================] - 4s 8ms/step - loss: 0.6931 - accuracy: 0.5041 - val_loss: 0.6941 - val_accuracy: 0.4875
Epoch 3/100
512/512 [==============================] - 5s 9ms/step - loss: 0.6931 - accuracy: 0.5023 - val_loss: 0.6930 - val_accuracy: 0.4875
Epoch 4/100
512/512 [==============================] - 4s 8ms/step - loss: 0.6926 - accuracy: 0.5195 - val_loss: 0.6932 - val_accuracy: 0.4875
Epoch 5/100
512/512 [==============================] - 4s 8ms/step - loss: 0.6899 - accuracy: 0.5414 - val_loss: 0.6943 - val_accuracy: 0.4875
Epoch 6/100
512/512 [==============================] - 4s 8ms/step - loss: 0.5971 - accuracy: 0.6879 - val_loss: 0.4025 - val_accuracy: 0.8687
Epoch 7/100
512/512 [==============================] - 4s 8ms/step - loss: 0.2743 - accuracy: 0.9045 - val_loss: 0.1916 - val_accuracy: 0.9258
Epoch 8/100
512/512 [==============================] - 4s 8ms/step - loss: 0.1825 - accuracy: 0.9279 - val_loss: 0.2614 - val_accuracy: 0.8836
Epoch 9/100
512/512 [==============================] - 4s 8ms/step - loss: 0.1351 - accuracy: 0.9500 - val_loss: 0.1538 - val_accuracy: 0.9258
Epoch 10/100
512/512 [==============================] - 4s 8ms/step - loss: 0.1324 - accuracy: 0.9453 - val_loss: 0.1255 - val_accuracy: 0.9477
Epoch 11/100
512/512 [==============================] - 4s 9ms/step - loss: 0.1226 - accuracy: 0.9561 - val_loss: 0.0857 - val_accuracy: 0.9703
Epoch 12/100
512/512 [==============================] - 4s 8ms/step - loss: 0.1062 - accuracy: 0.9604 - val_loss: 0.1159 - val_accuracy: 0.9570
Epoch 13/100
512/512 [==============================] - 4s 8ms/step - loss: 0.1072 - accuracy: 0.9566 - val_loss: 0.0742 - val_accuracy: 0.9734
Epoch 14/100
512/512 [==============================] - 4s 9ms/step - loss: 0.1064 - accuracy: 0.9580 - val_loss: 0.0755 - val_accuracy: 0.9727
Epoch 15/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0858 - accuracy: 0.9697 - val_loss: 0.0702 - val_accuracy: 0.9773
Epoch 16/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0765 - accuracy: 0.9715 - val_loss: 0.0731 - val_accuracy: 0.9742
Epoch 17/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0827 - accuracy: 0.9686 - val_loss: 0.0718 - val_accuracy: 0.9742
Epoch 18/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0798 - accuracy: 0.9678 - val_loss: 0.0627 - val_accuracy: 0.9773
Epoch 19/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0779 - accuracy: 0.9715 - val_loss: 0.0739 - val_accuracy: 0.9727
Epoch 20/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0614 - accuracy: 0.9770 - val_loss: 0.0521 - val_accuracy: 0.9797
Epoch 21/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0633 - accuracy: 0.9766 - val_loss: 0.0989 - val_accuracy: 0.9625
Epoch 22/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0799 - accuracy: 0.9682 - val_loss: 0.0512 - val_accuracy: 0.9812
Epoch 23/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0583 - accuracy: 0.9795 - val_loss: 0.0545 - val_accuracy: 0.9812
Epoch 24/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0506 - accuracy: 0.9832 - val_loss: 0.1503 - val_accuracy: 0.9430
Epoch 25/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0871 - accuracy: 0.9674 - val_loss: 0.0507 - val_accuracy: 0.9805
Epoch 26/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0614 - accuracy: 0.9758 - val_loss: 0.0483 - val_accuracy: 0.9812
Epoch 27/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0596 - accuracy: 0.9762 - val_loss: 0.0815 - val_accuracy: 0.9680
Epoch 28/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0626 - accuracy: 0.9762 - val_loss: 0.0492 - val_accuracy: 0.9805
Epoch 29/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0692 - accuracy: 0.9723 - val_loss: 0.0479 - val_accuracy: 0.9797
Epoch 30/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0538 - accuracy: 0.9803 - val_loss: 0.0487 - val_accuracy: 0.9805
Epoch 31/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0705 - accuracy: 0.9740 - val_loss: 0.0578 - val_accuracy: 0.9781
Epoch 32/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0524 - accuracy: 0.9805 - val_loss: 0.0540 - val_accuracy: 0.9781
Epoch 33/100
512/512 [==============================] - 5s 9ms/step - loss: 0.0678 - accuracy: 0.9758 - val_loss: 0.0511 - val_accuracy: 0.9797
Epoch 34/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0379 - accuracy: 0.9867 - val_loss: 0.1492 - val_accuracy: 0.9406
Epoch 35/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0245 - accuracy: 0.9920 - val_loss: 0.0390 - val_accuracy: 0.9875
Epoch 36/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0193 - accuracy: 0.9945 - val_loss: 0.0388 - val_accuracy: 0.9875
Epoch 37/100
512/512 [==============================] - 5s 9ms/step - loss: 0.0191 - accuracy: 0.9945 - val_loss: 0.0387 - val_accuracy: 0.9875
Epoch 38/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0190 - accuracy: 0.9949 - val_loss: 0.0384 - val_accuracy: 0.9883
Epoch 39/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0187 - accuracy: 0.9951 - val_loss: 0.0382 - val_accuracy: 0.9875
Epoch 40/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0188 - accuracy: 0.9949 - val_loss: 0.0385 - val_accuracy: 0.9875
Epoch 41/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0186 - accuracy: 0.9947 - val_loss: 0.0381 - val_accuracy: 0.9875
Epoch 42/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0186 - accuracy: 0.9943 - val_loss: 0.0381 - val_accuracy: 0.9875
Epoch 43/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0183 - accuracy: 0.9951 - val_loss: 0.0387 - val_accuracy: 0.9844
Epoch 44/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0183 - accuracy: 0.9945 - val_loss: 0.0374 - val_accuracy: 0.9859
Epoch 45/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0183 - accuracy: 0.9943 - val_loss: 0.0370 - val_accuracy: 0.9891
Epoch 46/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0181 - accuracy: 0.9949 - val_loss: 0.0367 - val_accuracy: 0.9898
Epoch 47/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0179 - accuracy: 0.9951 - val_loss: 0.0373 - val_accuracy: 0.9852
Epoch 48/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0179 - accuracy: 0.9949 - val_loss: 0.0365 - val_accuracy: 0.9875
Epoch 49/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0176 - accuracy: 0.9955 - val_loss: 0.0370 - val_accuracy: 0.9852
Epoch 50/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0176 - accuracy: 0.9953 - val_loss: 0.0360 - val_accuracy: 0.9883
Epoch 51/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0176 - accuracy: 0.9955 - val_loss: 0.0358 - val_accuracy: 0.9898
Epoch 52/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0173 - accuracy: 0.9945 - val_loss: 0.0356 - val_accuracy: 0.9898
Epoch 53/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0173 - accuracy: 0.9949 - val_loss: 0.0356 - val_accuracy: 0.9875
Epoch 54/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0172 - accuracy: 0.9951 - val_loss: 0.0354 - val_accuracy: 0.9891
Epoch 55/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0170 - accuracy: 0.9955 - val_loss: 0.0358 - val_accuracy: 0.9891
Epoch 56/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0169 - accuracy: 0.9953 - val_loss: 0.0365 - val_accuracy: 0.9891
Epoch 57/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0169 - accuracy: 0.9953 - val_loss: 0.0349 - val_accuracy: 0.9891
Epoch 58/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0168 - accuracy: 0.9957 - val_loss: 0.0349 - val_accuracy: 0.9898
Epoch 59/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0166 - accuracy: 0.9957 - val_loss: 0.0350 - val_accuracy: 0.9859
Epoch 60/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0164 - accuracy: 0.9957 - val_loss: 0.0368 - val_accuracy: 0.9852
Epoch 61/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0166 - accuracy: 0.9959 - val_loss: 0.0342 - val_accuracy: 0.9898
Epoch 62/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0164 - accuracy: 0.9955 - val_loss: 0.0347 - val_accuracy: 0.9898
Epoch 63/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0166 - accuracy: 0.9955 - val_loss: 0.0339 - val_accuracy: 0.9891
Epoch 64/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0164 - accuracy: 0.9963 - val_loss: 0.0338 - val_accuracy: 0.9891
Epoch 65/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0157 - accuracy: 0.9959 - val_loss: 0.0338 - val_accuracy: 0.9898
Epoch 66/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0162 - accuracy: 0.9955 - val_loss: 0.0335 - val_accuracy: 0.9891
Epoch 67/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0160 - accuracy: 0.9953 - val_loss: 0.0337 - val_accuracy: 0.9867
Epoch 68/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0160 - accuracy: 0.9959 - val_loss: 0.0342 - val_accuracy: 0.9867
Epoch 69/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0160 - accuracy: 0.9961 - val_loss: 0.0331 - val_accuracy: 0.9891
Epoch 70/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0157 - accuracy: 0.9957 - val_loss: 0.0330 - val_accuracy: 0.9898
Epoch 71/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0157 - accuracy: 0.9955 - val_loss: 0.0333 - val_accuracy: 0.9906
Epoch 72/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0157 - accuracy: 0.9957 - val_loss: 0.0326 - val_accuracy: 0.9898
Epoch 73/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0155 - accuracy: 0.9961 - val_loss: 0.0326 - val_accuracy: 0.9891
Epoch 74/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0155 - accuracy: 0.9961 - val_loss: 0.0324 - val_accuracy: 0.9898
Epoch 75/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0154 - accuracy: 0.9959 - val_loss: 0.0321 - val_accuracy: 0.9906
Epoch 76/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0155 - accuracy: 0.9949 - val_loss: 0.0321 - val_accuracy: 0.9898
Epoch 77/100
512/512 [==============================] - 5s 9ms/step - loss: 0.0152 - accuracy: 0.9963 - val_loss: 0.0324 - val_accuracy: 0.9883
Epoch 78/100
512/512 [==============================] - 5s 9ms/step - loss: 0.0152 - accuracy: 0.9957 - val_loss: 0.0320 - val_accuracy: 0.9906
Epoch 79/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0153 - accuracy: 0.9961 - val_loss: 0.0318 - val_accuracy: 0.9883
Epoch 80/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0150 - accuracy: 0.9957 - val_loss: 0.0315 - val_accuracy: 0.9898
Epoch 81/100
512/512 [==============================] - 5s 9ms/step - loss: 0.0150 - accuracy: 0.9961 - val_loss: 0.0314 - val_accuracy: 0.9906
Epoch 82/100
512/512 [==============================] - 5s 9ms/step - loss: 0.0147 - accuracy: 0.9965 - val_loss: 0.0328 - val_accuracy: 0.9891
Epoch 83/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0148 - accuracy: 0.9957 - val_loss: 0.0315 - val_accuracy: 0.9906
Epoch 84/100
512/512 [==============================] - 5s 9ms/step - loss: 0.0148 - accuracy: 0.9963 - val_loss: 0.0311 - val_accuracy: 0.9906
Epoch 85/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0146 - accuracy: 0.9963 - val_loss: 0.0312 - val_accuracy: 0.9906
Epoch 86/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0146 - accuracy: 0.9961 - val_loss: 0.0309 - val_accuracy: 0.9906
Epoch 87/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0146 - accuracy: 0.9963 - val_loss: 0.0312 - val_accuracy: 0.9914
Epoch 88/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0142 - accuracy: 0.9961 - val_loss: 0.0315 - val_accuracy: 0.9875
Epoch 89/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0144 - accuracy: 0.9963 - val_loss: 0.0305 - val_accuracy: 0.9906
Epoch 90/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0142 - accuracy: 0.9967 - val_loss: 0.0306 - val_accuracy: 0.9891
Epoch 91/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0144 - accuracy: 0.9953 - val_loss: 0.0302 - val_accuracy: 0.9898
Epoch 92/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0142 - accuracy: 0.9957 - val_loss: 0.0302 - val_accuracy: 0.9906
Epoch 93/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0141 - accuracy: 0.9963 - val_loss: 0.0300 - val_accuracy: 0.9906
Epoch 94/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0141 - accuracy: 0.9957 - val_loss: 0.0301 - val_accuracy: 0.9906
Epoch 95/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0139 - accuracy: 0.9957 - val_loss: 0.0310 - val_accuracy: 0.9875
Epoch 96/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0140 - accuracy: 0.9955 - val_loss: 0.0296 - val_accuracy: 0.9906
Epoch 97/100
512/512 [==============================] - 4s 9ms/step - loss: 0.0139 - accuracy: 0.9965 - val_loss: 0.0295 - val_accuracy: 0.9914
Epoch 98/100
512/512 [==============================] - 5s 9ms/step - loss: 0.0138 - accuracy: 0.9963 - val_loss: 0.0295 - val_accuracy: 0.9906
Epoch 99/100
512/512 [==============================] - 5s 9ms/step - loss: 0.0135 - accuracy: 0.9969 - val_loss: 0.0318 - val_accuracy: 0.9906
Epoch 100/100
512/512 [==============================] - 4s 8ms/step - loss: 0.0138 - accuracy: 0.9957 - val_loss: 0.0301 - val_accuracy: 0.9883
_________________________________________________________________

accuracy: 98.45%
_________________________________________________________________






(ML) [haharder@hepp01 code]$ python CNN.py -cn clas10_05 -v

Performing 5-Fold cross validation
________________________________________________________________

Analysis: classification
________________________________________________________________

Training for fold 1...
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 28, 28, 16)        8016
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 14, 14, 16)        0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 14, 14, 32)        12832
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 7, 7, 32)          0
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 7, 7, 64)          51264
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 3, 3, 64)          0
_________________________________________________________________
flatten (Flatten)            (None, 576)               0
_________________________________________________________________
dense (Dense)                (None, 128)               73856
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 129
=================================================================
Total params: 146,097
Trainable params: 146,097
Non-trainable params: 0
_________________________________________________________________

training: 5120 - validation: 1280 - Untrained, accuracy: 50.70%
_________________________________________________________________

Epoch 1/100
410/410 [==============================] - 4s 8ms/step - loss: 0.6936 - accuracy: 0.4893 - val_loss: 0.6931 - val_accuracy: 0.5059
Epoch 2/100
410/410 [==============================] - 3s 8ms/step - loss: 0.6933 - accuracy: 0.4990 - val_loss: 0.6931 - val_accuracy: 0.5059
Epoch 3/100
410/410 [==============================] - 3s 8ms/step - loss: 0.6932 - accuracy: 0.5037 - val_loss: 0.6932 - val_accuracy: 0.4922
Epoch 4/100
410/410 [==============================] - 3s 8ms/step - loss: 0.6931 - accuracy: 0.5051 - val_loss: 0.6929 - val_accuracy: 0.4922
Epoch 5/100
410/410 [==============================] - 3s 8ms/step - loss: 0.6923 - accuracy: 0.5176 - val_loss: 0.6948 - val_accuracy: 0.4922
Epoch 6/100
410/410 [==============================] - 3s 8ms/step - loss: 0.6911 - accuracy: 0.5242 - val_loss: 0.6861 - val_accuracy: 0.6035
Epoch 7/100
410/410 [==============================] - 3s 8ms/step - loss: 0.6805 - accuracy: 0.5649 - val_loss: 0.6354 - val_accuracy: 0.7129
Epoch 8/100
410/410 [==============================] - 4s 9ms/step - loss: 0.4598 - accuracy: 0.7983 - val_loss: 0.3518 - val_accuracy: 0.8330
Epoch 9/100
410/410 [==============================] - 3s 8ms/step - loss: 0.2195 - accuracy: 0.9160 - val_loss: 0.1670 - val_accuracy: 0.9287
Epoch 10/100
410/410 [==============================] - 3s 8ms/step - loss: 0.1624 - accuracy: 0.9380 - val_loss: 0.1585 - val_accuracy: 0.9336
Epoch 11/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1267 - accuracy: 0.9519 - val_loss: 0.1059 - val_accuracy: 0.9629
Epoch 12/100
410/410 [==============================] - 3s 8ms/step - loss: 0.1122 - accuracy: 0.9575 - val_loss: 0.2223 - val_accuracy: 0.9062
Epoch 13/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0992 - accuracy: 0.9619 - val_loss: 0.1318 - val_accuracy: 0.9492
Epoch 14/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1214 - accuracy: 0.9561 - val_loss: 0.0941 - val_accuracy: 0.9658
Epoch 15/100
410/410 [==============================] - 3s 8ms/step - loss: 0.0863 - accuracy: 0.9675 - val_loss: 0.0774 - val_accuracy: 0.9697
Epoch 16/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0736 - accuracy: 0.9731 - val_loss: 0.0680 - val_accuracy: 0.9736
Epoch 17/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0844 - accuracy: 0.9680 - val_loss: 0.0829 - val_accuracy: 0.9678
Epoch 18/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0818 - accuracy: 0.9688 - val_loss: 0.0999 - val_accuracy: 0.9648
Epoch 19/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0782 - accuracy: 0.9695 - val_loss: 0.1692 - val_accuracy: 0.9277
Epoch 20/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0701 - accuracy: 0.9749 - val_loss: 0.0764 - val_accuracy: 0.9717
Epoch 21/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0747 - accuracy: 0.9722 - val_loss: 0.4031 - val_accuracy: 0.8555
Epoch 22/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0736 - accuracy: 0.9717 - val_loss: 0.0622 - val_accuracy: 0.9756
Epoch 23/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0790 - accuracy: 0.9700 - val_loss: 0.0615 - val_accuracy: 0.9727
Epoch 24/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0508 - accuracy: 0.9839 - val_loss: 0.1229 - val_accuracy: 0.9473
Epoch 25/100
410/410 [==============================] - 3s 8ms/step - loss: 0.0731 - accuracy: 0.9739 - val_loss: 0.0936 - val_accuracy: 0.9639
Epoch 26/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0716 - accuracy: 0.9700 - val_loss: 0.0898 - val_accuracy: 0.9639
Epoch 27/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0558 - accuracy: 0.9783 - val_loss: 0.0532 - val_accuracy: 0.9746
Epoch 28/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0641 - accuracy: 0.9753 - val_loss: 0.0629 - val_accuracy: 0.9746
Epoch 29/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0549 - accuracy: 0.9807 - val_loss: 0.0511 - val_accuracy: 0.9756
Epoch 30/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0586 - accuracy: 0.9780 - val_loss: 0.3818 - val_accuracy: 0.8691
Epoch 31/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0450 - accuracy: 0.9832 - val_loss: 0.0640 - val_accuracy: 0.9775
Epoch 32/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0421 - accuracy: 0.9873 - val_loss: 0.0474 - val_accuracy: 0.9756
Epoch 33/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0702 - accuracy: 0.9724 - val_loss: 0.0546 - val_accuracy: 0.9736
Epoch 34/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0626 - accuracy: 0.9775 - val_loss: 0.0937 - val_accuracy: 0.9648
Epoch 35/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0528 - accuracy: 0.9817 - val_loss: 0.0572 - val_accuracy: 0.9756
Epoch 36/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0545 - accuracy: 0.9814 - val_loss: 0.0730 - val_accuracy: 0.9756
Epoch 37/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0440 - accuracy: 0.9836 - val_loss: 0.0686 - val_accuracy: 0.9736
Epoch 38/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0464 - accuracy: 0.9836 - val_loss: 0.0465 - val_accuracy: 0.9775
Epoch 39/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0461 - accuracy: 0.9832 - val_loss: 0.0640 - val_accuracy: 0.9766
Epoch 40/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0579 - accuracy: 0.9790 - val_loss: 0.0647 - val_accuracy: 0.9727
Epoch 41/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0526 - accuracy: 0.9812 - val_loss: 0.0949 - val_accuracy: 0.9639
Epoch 42/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0424 - accuracy: 0.9844 - val_loss: 0.2707 - val_accuracy: 0.9043
Epoch 43/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0456 - accuracy: 0.9817 - val_loss: 0.0710 - val_accuracy: 0.9766
Epoch 44/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0362 - accuracy: 0.9873 - val_loss: 0.0406 - val_accuracy: 0.9795
Epoch 45/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0319 - accuracy: 0.9890 - val_loss: 0.0373 - val_accuracy: 0.9805
Epoch 46/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0302 - accuracy: 0.9907 - val_loss: 0.0626 - val_accuracy: 0.9736
Epoch 47/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0253 - accuracy: 0.9919 - val_loss: 0.0637 - val_accuracy: 0.9746
Epoch 48/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0463 - accuracy: 0.9819 - val_loss: 0.0448 - val_accuracy: 0.9785
Epoch 49/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0315 - accuracy: 0.9883 - val_loss: 0.1078 - val_accuracy: 0.9590
Epoch 50/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0273 - accuracy: 0.9915 - val_loss: 0.0502 - val_accuracy: 0.9766
Epoch 51/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0305 - accuracy: 0.9885 - val_loss: 0.0468 - val_accuracy: 0.9805
Epoch 52/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0558 - accuracy: 0.9807 - val_loss: 0.3529 - val_accuracy: 0.8789
Epoch 53/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0308 - accuracy: 0.9888 - val_loss: 0.0503 - val_accuracy: 0.9766
Epoch 54/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0285 - accuracy: 0.9910 - val_loss: 0.0448 - val_accuracy: 0.9785
Epoch 55/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0414 - accuracy: 0.9895 - val_loss: 0.0517 - val_accuracy: 0.9775
Epoch 56/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0327 - accuracy: 0.9895 - val_loss: 0.0490 - val_accuracy: 0.9756
Epoch 57/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0383 - accuracy: 0.9858 - val_loss: 0.0484 - val_accuracy: 0.9746
Epoch 58/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0290 - accuracy: 0.9893 - val_loss: 0.1700 - val_accuracy: 0.9424
Epoch 59/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0395 - accuracy: 0.9878 - val_loss: 0.0531 - val_accuracy: 0.9785
Epoch 60/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0324 - accuracy: 0.9905 - val_loss: 0.0503 - val_accuracy: 0.9766
Epoch 61/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0164 - accuracy: 0.9944 - val_loss: 0.0430 - val_accuracy: 0.9785
Epoch 62/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0479 - accuracy: 0.9839 - val_loss: 0.0943 - val_accuracy: 0.9609
Epoch 63/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0235 - accuracy: 0.9944 - val_loss: 0.2633 - val_accuracy: 0.9170
Epoch 64/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0203 - accuracy: 0.9934 - val_loss: 0.0757 - val_accuracy: 0.9697
Epoch 65/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0308 - accuracy: 0.9885 - val_loss: 0.1941 - val_accuracy: 0.9326
Training for fold 1 - loss: 0.2037 - accuracy: 0.9381
Training for fold 2...
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_3 (Conv2D)            (None, 28, 28, 16)        8016
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 14, 14, 16)        0
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 14, 14, 32)        12832
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 7, 7, 32)          0
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 7, 7, 64)          51264
_________________________________________________________________
max_pooling2d_5 (MaxPooling2 (None, 3, 3, 64)          0
_________________________________________________________________
flatten_1 (Flatten)          (None, 576)               0
_________________________________________________________________
dense_2 (Dense)              (None, 128)               73856
_________________________________________________________________
dense_3 (Dense)              (None, 1)                 129
=================================================================
Total params: 146,097
Trainable params: 146,097
Non-trainable params: 0
_________________________________________________________________

training: 5120 - validation: 1280 - Untrained, accuracy: 49.45%
_________________________________________________________________

Epoch 1/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6934 - accuracy: 0.4985 - val_loss: 0.6931 - val_accuracy: 0.5215
Epoch 2/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6933 - accuracy: 0.4924 - val_loss: 0.6934 - val_accuracy: 0.4805
Epoch 3/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6932 - accuracy: 0.5020 - val_loss: 0.6929 - val_accuracy: 0.5254
Epoch 4/100
410/410 [==============================] - 4s 10ms/step - loss: 0.6931 - accuracy: 0.5127 - val_loss: 0.6933 - val_accuracy: 0.4805
Epoch 5/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6930 - accuracy: 0.5095 - val_loss: 0.6940 - val_accuracy: 0.4805
Epoch 6/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6927 - accuracy: 0.5164 - val_loss: 0.6914 - val_accuracy: 0.5205
Epoch 7/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6911 - accuracy: 0.5310 - val_loss: 0.6906 - val_accuracy: 0.5498
Epoch 8/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6837 - accuracy: 0.5576 - val_loss: 0.6642 - val_accuracy: 0.6357
Epoch 9/100
410/410 [==============================] - 4s 9ms/step - loss: 0.5648 - accuracy: 0.7236 - val_loss: 0.4151 - val_accuracy: 0.8086
Epoch 10/100
410/410 [==============================] - 4s 9ms/step - loss: 0.2650 - accuracy: 0.9009 - val_loss: 0.2423 - val_accuracy: 0.9033
Epoch 11/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1841 - accuracy: 0.9321 - val_loss: 0.1497 - val_accuracy: 0.9434
Epoch 12/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1546 - accuracy: 0.9417 - val_loss: 0.1155 - val_accuracy: 0.9590
Epoch 13/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1496 - accuracy: 0.9409 - val_loss: 0.1218 - val_accuracy: 0.9541
Epoch 14/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1239 - accuracy: 0.9536 - val_loss: 0.0916 - val_accuracy: 0.9648
Epoch 15/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0941 - accuracy: 0.9646 - val_loss: 0.0736 - val_accuracy: 0.9727
Epoch 16/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0855 - accuracy: 0.9673 - val_loss: 0.0721 - val_accuracy: 0.9727
Epoch 17/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0771 - accuracy: 0.9719 - val_loss: 0.0526 - val_accuracy: 0.9795
Epoch 18/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0815 - accuracy: 0.9734 - val_loss: 0.8495 - val_accuracy: 0.6982
Epoch 19/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0965 - accuracy: 0.9592 - val_loss: 0.1112 - val_accuracy: 0.9502
Epoch 20/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0729 - accuracy: 0.9690 - val_loss: 0.0562 - val_accuracy: 0.9785
Epoch 21/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0686 - accuracy: 0.9724 - val_loss: 0.0425 - val_accuracy: 0.9844
Epoch 22/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0829 - accuracy: 0.9692 - val_loss: 0.6881 - val_accuracy: 0.7676
Epoch 23/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0792 - accuracy: 0.9719 - val_loss: 0.0488 - val_accuracy: 0.9834
Epoch 24/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0650 - accuracy: 0.9753 - val_loss: 0.0492 - val_accuracy: 0.9824
Epoch 25/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0711 - accuracy: 0.9714 - val_loss: 0.0664 - val_accuracy: 0.9717
Epoch 26/100
410/410 [==============================] - 3s 9ms/step - loss: 0.0816 - accuracy: 0.9688 - val_loss: 0.1711 - val_accuracy: 0.9336
Epoch 27/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0535 - accuracy: 0.9829 - val_loss: 0.0368 - val_accuracy: 0.9873
Epoch 28/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0730 - accuracy: 0.9744 - val_loss: 0.0481 - val_accuracy: 0.9844
Epoch 29/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0416 - accuracy: 0.9868 - val_loss: 0.0534 - val_accuracy: 0.9775
Epoch 30/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0564 - accuracy: 0.9788 - val_loss: 0.1045 - val_accuracy: 0.9609
Epoch 31/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0629 - accuracy: 0.9763 - val_loss: 0.0458 - val_accuracy: 0.9844
Epoch 32/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0654 - accuracy: 0.9753 - val_loss: 0.0373 - val_accuracy: 0.9834
Epoch 33/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0532 - accuracy: 0.9829 - val_loss: 0.2100 - val_accuracy: 0.9160
Epoch 34/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0411 - accuracy: 0.9839 - val_loss: 0.0356 - val_accuracy: 0.9883
Epoch 35/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0526 - accuracy: 0.9827 - val_loss: 0.0649 - val_accuracy: 0.9756
Epoch 36/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0704 - accuracy: 0.9707 - val_loss: 0.1634 - val_accuracy: 0.9424
Epoch 37/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0360 - accuracy: 0.9871 - val_loss: 0.2021 - val_accuracy: 0.9238
Epoch 38/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0466 - accuracy: 0.9846 - val_loss: 0.0487 - val_accuracy: 0.9795
Epoch 39/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0389 - accuracy: 0.9868 - val_loss: 0.0297 - val_accuracy: 0.9883
Epoch 40/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0436 - accuracy: 0.9834 - val_loss: 0.0440 - val_accuracy: 0.9805
Epoch 41/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0523 - accuracy: 0.9807 - val_loss: 0.0675 - val_accuracy: 0.9746
Epoch 42/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0368 - accuracy: 0.9856 - val_loss: 0.0543 - val_accuracy: 0.9805
Epoch 43/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0642 - accuracy: 0.9749 - val_loss: 0.0334 - val_accuracy: 0.9834
Epoch 44/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0410 - accuracy: 0.9851 - val_loss: 0.0356 - val_accuracy: 0.9854
Epoch 45/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0372 - accuracy: 0.9863 - val_loss: 0.0449 - val_accuracy: 0.9805
Epoch 46/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0379 - accuracy: 0.9878 - val_loss: 0.3706 - val_accuracy: 0.8760
Epoch 47/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0762 - accuracy: 0.9729 - val_loss: 0.0407 - val_accuracy: 0.9844
Epoch 48/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0257 - accuracy: 0.9912 - val_loss: 0.0342 - val_accuracy: 0.9883
Epoch 49/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0523 - accuracy: 0.9807 - val_loss: 0.0726 - val_accuracy: 0.9697
Epoch 50/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0409 - accuracy: 0.9834 - val_loss: 0.0386 - val_accuracy: 0.9854
Epoch 51/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0399 - accuracy: 0.9846 - val_loss: 0.0530 - val_accuracy: 0.9795
Epoch 52/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0440 - accuracy: 0.9836 - val_loss: 0.0282 - val_accuracy: 0.9893
Epoch 53/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0505 - accuracy: 0.9827 - val_loss: 0.0522 - val_accuracy: 0.9785
Epoch 54/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0393 - accuracy: 0.9858 - val_loss: 0.0451 - val_accuracy: 0.9834
Epoch 55/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0379 - accuracy: 0.9866 - val_loss: 0.0693 - val_accuracy: 0.9756
Epoch 56/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0557 - accuracy: 0.9785 - val_loss: 0.1833 - val_accuracy: 0.9336
Epoch 57/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0294 - accuracy: 0.9885 - val_loss: 0.0287 - val_accuracy: 0.9883
Epoch 58/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0483 - accuracy: 0.9814 - val_loss: 0.0585 - val_accuracy: 0.9775
Epoch 59/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0596 - accuracy: 0.9800 - val_loss: 0.0420 - val_accuracy: 0.9775
Epoch 60/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0272 - accuracy: 0.9915 - val_loss: 0.0310 - val_accuracy: 0.9863
Epoch 61/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0241 - accuracy: 0.9902 - val_loss: 0.0301 - val_accuracy: 0.9873
Epoch 62/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0464 - accuracy: 0.9822 - val_loss: 0.0330 - val_accuracy: 0.9883
Epoch 63/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0401 - accuracy: 0.9836 - val_loss: 0.0637 - val_accuracy: 0.9785
Epoch 64/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0258 - accuracy: 0.9910 - val_loss: 0.1223 - val_accuracy: 0.9629
Epoch 65/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0439 - accuracy: 0.9836 - val_loss: 0.1416 - val_accuracy: 0.9521
Epoch 66/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0487 - accuracy: 0.9841 - val_loss: 0.0497 - val_accuracy: 0.9746
Epoch 67/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0252 - accuracy: 0.9910 - val_loss: 0.0449 - val_accuracy: 0.9785
Epoch 68/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0540 - accuracy: 0.9797 - val_loss: 0.0715 - val_accuracy: 0.9775
Epoch 69/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0367 - accuracy: 0.9875 - val_loss: 0.0750 - val_accuracy: 0.9756
Epoch 70/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0466 - accuracy: 0.9824 - val_loss: 0.0436 - val_accuracy: 0.9824
Epoch 71/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0289 - accuracy: 0.9897 - val_loss: 0.0554 - val_accuracy: 0.9795
Epoch 72/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0354 - accuracy: 0.9866 - val_loss: 0.2519 - val_accuracy: 0.9209
Training for fold 2 - loss: 0.2301 - accuracy: 0.9281
Training for fold 3...
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_6 (Conv2D)            (None, 28, 28, 16)        8016
_________________________________________________________________
max_pooling2d_6 (MaxPooling2 (None, 14, 14, 16)        0
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 14, 14, 32)        12832
_________________________________________________________________
max_pooling2d_7 (MaxPooling2 (None, 7, 7, 32)          0
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 7, 7, 64)          51264
_________________________________________________________________
max_pooling2d_8 (MaxPooling2 (None, 3, 3, 64)          0
_________________________________________________________________
flatten_2 (Flatten)          (None, 576)               0
_________________________________________________________________
dense_4 (Dense)              (None, 128)               73856
_________________________________________________________________
dense_5 (Dense)              (None, 1)                 129
=================================================================
Total params: 146,097
Trainable params: 146,097
Non-trainable params: 0
_________________________________________________________________

training: 5120 - validation: 1280 - Untrained, accuracy: 47.73%
_________________________________________________________________

Epoch 1/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6934 - accuracy: 0.5122 - val_loss: 0.6933 - val_accuracy: 0.4893
Epoch 2/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6933 - accuracy: 0.4917 - val_loss: 0.6931 - val_accuracy: 0.5117
Epoch 3/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6932 - accuracy: 0.5063 - val_loss: 0.6934 - val_accuracy: 0.4893
Epoch 4/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6931 - accuracy: 0.5054 - val_loss: 0.6931 - val_accuracy: 0.5195
Epoch 5/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6929 - accuracy: 0.5137 - val_loss: 0.6928 - val_accuracy: 0.5107
Epoch 6/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6928 - accuracy: 0.5098 - val_loss: 0.6928 - val_accuracy: 0.5068
Epoch 7/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6924 - accuracy: 0.5261 - val_loss: 0.6918 - val_accuracy: 0.5283
Epoch 8/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6892 - accuracy: 0.5415 - val_loss: 0.6860 - val_accuracy: 0.5205
Epoch 9/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6636 - accuracy: 0.6123 - val_loss: 0.6336 - val_accuracy: 0.5859
Epoch 10/100
410/410 [==============================] - 4s 9ms/step - loss: 0.5450 - accuracy: 0.7573 - val_loss: 0.4277 - val_accuracy: 0.8379
Epoch 11/100
410/410 [==============================] - 4s 9ms/step - loss: 0.3434 - accuracy: 0.8745 - val_loss: 0.3224 - val_accuracy: 0.8594
Epoch 12/100
410/410 [==============================] - 4s 9ms/step - loss: 0.2259 - accuracy: 0.9226 - val_loss: 0.1827 - val_accuracy: 0.9473
Epoch 13/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1760 - accuracy: 0.9385 - val_loss: 0.1557 - val_accuracy: 0.9375
Epoch 14/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1428 - accuracy: 0.9495 - val_loss: 0.1464 - val_accuracy: 0.9414
Epoch 15/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1310 - accuracy: 0.9514 - val_loss: 0.1587 - val_accuracy: 0.9277
Epoch 16/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1158 - accuracy: 0.9561 - val_loss: 0.0982 - val_accuracy: 0.9648
Epoch 17/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0895 - accuracy: 0.9712 - val_loss: 0.0888 - val_accuracy: 0.9736
Epoch 18/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0787 - accuracy: 0.9729 - val_loss: 0.0775 - val_accuracy: 0.9785
Epoch 19/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1090 - accuracy: 0.9563 - val_loss: 0.2302 - val_accuracy: 0.9004
Epoch 20/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0833 - accuracy: 0.9722 - val_loss: 0.0814 - val_accuracy: 0.9717
Epoch 21/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0712 - accuracy: 0.9749 - val_loss: 0.0722 - val_accuracy: 0.9746
Epoch 22/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0757 - accuracy: 0.9724 - val_loss: 0.0642 - val_accuracy: 0.9766
Epoch 23/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1006 - accuracy: 0.9636 - val_loss: 0.0889 - val_accuracy: 0.9688
Epoch 24/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0780 - accuracy: 0.9717 - val_loss: 0.0617 - val_accuracy: 0.9775
Epoch 25/100
410/410 [==============================] - 3s 9ms/step - loss: 0.0718 - accuracy: 0.9736 - val_loss: 0.0728 - val_accuracy: 0.9756
Epoch 26/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0767 - accuracy: 0.9717 - val_loss: 0.1318 - val_accuracy: 0.9502
Epoch 27/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0984 - accuracy: 0.9612 - val_loss: 0.1761 - val_accuracy: 0.9268
Epoch 28/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0543 - accuracy: 0.9807 - val_loss: 0.1015 - val_accuracy: 0.9609
Epoch 29/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0639 - accuracy: 0.9768 - val_loss: 0.1002 - val_accuracy: 0.9658
Epoch 30/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0786 - accuracy: 0.9700 - val_loss: 0.1263 - val_accuracy: 0.9502
Epoch 31/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0525 - accuracy: 0.9824 - val_loss: 0.1161 - val_accuracy: 0.9541
Epoch 32/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0771 - accuracy: 0.9719 - val_loss: 0.0617 - val_accuracy: 0.9785
Epoch 33/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0674 - accuracy: 0.9751 - val_loss: 0.0692 - val_accuracy: 0.9746
Epoch 34/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0696 - accuracy: 0.9749 - val_loss: 0.0559 - val_accuracy: 0.9814
Epoch 35/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0407 - accuracy: 0.9861 - val_loss: 0.0559 - val_accuracy: 0.9805
Epoch 36/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0753 - accuracy: 0.9692 - val_loss: 0.1029 - val_accuracy: 0.9639
Epoch 37/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0720 - accuracy: 0.9746 - val_loss: 0.1496 - val_accuracy: 0.9404
Epoch 38/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0389 - accuracy: 0.9856 - val_loss: 0.0667 - val_accuracy: 0.9814
Epoch 39/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0421 - accuracy: 0.9854 - val_loss: 0.1011 - val_accuracy: 0.9600
Epoch 40/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0568 - accuracy: 0.9783 - val_loss: 0.0510 - val_accuracy: 0.9775
Epoch 41/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0505 - accuracy: 0.9802 - val_loss: 0.0466 - val_accuracy: 0.9814
Epoch 42/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0352 - accuracy: 0.9873 - val_loss: 0.0469 - val_accuracy: 0.9805
Epoch 43/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0704 - accuracy: 0.9739 - val_loss: 0.0530 - val_accuracy: 0.9805
Epoch 44/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0409 - accuracy: 0.9866 - val_loss: 0.0440 - val_accuracy: 0.9834
Epoch 45/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0428 - accuracy: 0.9844 - val_loss: 0.0618 - val_accuracy: 0.9814
Epoch 46/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0378 - accuracy: 0.9868 - val_loss: 0.0472 - val_accuracy: 0.9805
Epoch 47/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0453 - accuracy: 0.9822 - val_loss: 0.0951 - val_accuracy: 0.9658
Epoch 48/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0961 - accuracy: 0.9619 - val_loss: 0.0506 - val_accuracy: 0.9805
Epoch 49/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0380 - accuracy: 0.9861 - val_loss: 0.0675 - val_accuracy: 0.9805
Epoch 50/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0398 - accuracy: 0.9866 - val_loss: 0.1120 - val_accuracy: 0.9531
Epoch 51/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0431 - accuracy: 0.9849 - val_loss: 0.0426 - val_accuracy: 0.9824
Epoch 52/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0301 - accuracy: 0.9890 - val_loss: 0.1256 - val_accuracy: 0.9531
Epoch 53/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0323 - accuracy: 0.9871 - val_loss: 0.0712 - val_accuracy: 0.9717
Epoch 54/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0345 - accuracy: 0.9858 - val_loss: 0.0415 - val_accuracy: 0.9834
Epoch 55/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0555 - accuracy: 0.9780 - val_loss: 0.1303 - val_accuracy: 0.9473
Epoch 56/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0480 - accuracy: 0.9834 - val_loss: 0.0441 - val_accuracy: 0.9844
Epoch 57/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0284 - accuracy: 0.9902 - val_loss: 0.1462 - val_accuracy: 0.9453
Epoch 58/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0406 - accuracy: 0.9858 - val_loss: 0.0450 - val_accuracy: 0.9873
Epoch 59/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0335 - accuracy: 0.9890 - val_loss: 0.9882 - val_accuracy: 0.7471
Epoch 60/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0294 - accuracy: 0.9905 - val_loss: 0.0958 - val_accuracy: 0.9629
Epoch 61/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0200 - accuracy: 0.9924 - val_loss: 0.0820 - val_accuracy: 0.9736
Epoch 62/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0248 - accuracy: 0.9905 - val_loss: 0.0386 - val_accuracy: 0.9863
Epoch 63/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0723 - accuracy: 0.9734 - val_loss: 0.0708 - val_accuracy: 0.9727
Epoch 64/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0283 - accuracy: 0.9902 - val_loss: 0.0455 - val_accuracy: 0.9854
Epoch 65/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0450 - accuracy: 0.9814 - val_loss: 0.0478 - val_accuracy: 0.9795
Epoch 66/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0163 - accuracy: 0.9949 - val_loss: 0.0414 - val_accuracy: 0.9863
Epoch 67/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0450 - accuracy: 0.9863 - val_loss: 0.0784 - val_accuracy: 0.9766
Epoch 68/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0265 - accuracy: 0.9897 - val_loss: 0.0470 - val_accuracy: 0.9805
Epoch 69/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0229 - accuracy: 0.9917 - val_loss: 0.0550 - val_accuracy: 0.9775
Epoch 70/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0229 - accuracy: 0.9910 - val_loss: 0.0424 - val_accuracy: 0.9805
Epoch 71/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0130 - accuracy: 0.9949 - val_loss: 0.0455 - val_accuracy: 0.9863
Epoch 72/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0614 - accuracy: 0.9771 - val_loss: 0.0936 - val_accuracy: 0.9658
Epoch 73/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0309 - accuracy: 0.9907 - val_loss: 0.0455 - val_accuracy: 0.9873
Epoch 74/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0142 - accuracy: 0.9951 - val_loss: 0.0640 - val_accuracy: 0.9746
Epoch 75/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0690 - accuracy: 0.9775 - val_loss: 0.0528 - val_accuracy: 0.9824
Epoch 76/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0134 - accuracy: 0.9966 - val_loss: 0.0506 - val_accuracy: 0.9756
Epoch 77/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0162 - accuracy: 0.9949 - val_loss: 0.0638 - val_accuracy: 0.9775
Epoch 78/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0164 - accuracy: 0.9946 - val_loss: 0.0444 - val_accuracy: 0.9814
Epoch 79/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0582 - accuracy: 0.9812 - val_loss: 0.0857 - val_accuracy: 0.9717
Epoch 80/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0264 - accuracy: 0.9910 - val_loss: 0.1038 - val_accuracy: 0.9590
Epoch 81/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0392 - accuracy: 0.9856 - val_loss: 0.0977 - val_accuracy: 0.9639
Epoch 82/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0135 - accuracy: 0.9956 - val_loss: 0.0462 - val_accuracy: 0.9873
Training for fold 3 - loss: 0.0359 - accuracy: 0.9862
Training for fold 4...
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_9 (Conv2D)            (None, 28, 28, 16)        8016
_________________________________________________________________
max_pooling2d_9 (MaxPooling2 (None, 14, 14, 16)        0
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 14, 14, 32)        12832
_________________________________________________________________
max_pooling2d_10 (MaxPooling (None, 7, 7, 32)          0
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 7, 7, 64)          51264
_________________________________________________________________
max_pooling2d_11 (MaxPooling (None, 3, 3, 64)          0
_________________________________________________________________
flatten_3 (Flatten)          (None, 576)               0
_________________________________________________________________
dense_6 (Dense)              (None, 128)               73856
_________________________________________________________________
dense_7 (Dense)              (None, 1)                 129
=================================================================
Total params: 146,097
Trainable params: 146,097
Non-trainable params: 0
_________________________________________________________________

training: 5120 - validation: 1280 - Untrained, accuracy: 51.09%
_________________________________________________________________

Epoch 1/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6935 - accuracy: 0.4888 - val_loss: 0.6932 - val_accuracy: 0.4893
Epoch 2/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6932 - accuracy: 0.4978 - val_loss: 0.6932 - val_accuracy: 0.4893
Epoch 3/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6932 - accuracy: 0.4995 - val_loss: 0.6931 - val_accuracy: 0.4951
Epoch 4/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6932 - accuracy: 0.5066 - val_loss: 0.6932 - val_accuracy: 0.4902
Epoch 5/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6931 - accuracy: 0.4980 - val_loss: 0.6930 - val_accuracy: 0.5146
Epoch 6/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6932 - accuracy: 0.5007 - val_loss: 0.6932 - val_accuracy: 0.4912
Epoch 7/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6931 - accuracy: 0.5061 - val_loss: 0.6927 - val_accuracy: 0.5508
Epoch 8/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6929 - accuracy: 0.5137 - val_loss: 0.6933 - val_accuracy: 0.4893
Epoch 9/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6925 - accuracy: 0.5142 - val_loss: 0.6916 - val_accuracy: 0.5488
Epoch 10/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6889 - accuracy: 0.5498 - val_loss: 0.6879 - val_accuracy: 0.5020
Epoch 11/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6327 - accuracy: 0.6655 - val_loss: 0.5252 - val_accuracy: 0.7949
Epoch 12/100
410/410 [==============================] - 4s 9ms/step - loss: 0.3809 - accuracy: 0.8538 - val_loss: 0.3510 - val_accuracy: 0.8301
Epoch 13/100
410/410 [==============================] - 4s 9ms/step - loss: 0.2393 - accuracy: 0.9092 - val_loss: 0.2432 - val_accuracy: 0.9043
Epoch 14/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1686 - accuracy: 0.9404 - val_loss: 0.3888 - val_accuracy: 0.8125
Epoch 15/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1476 - accuracy: 0.9436 - val_loss: 0.1113 - val_accuracy: 0.9619
Epoch 16/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1415 - accuracy: 0.9417 - val_loss: 0.0911 - val_accuracy: 0.9717
Epoch 17/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1045 - accuracy: 0.9626 - val_loss: 0.1473 - val_accuracy: 0.9395
Epoch 18/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1136 - accuracy: 0.9553 - val_loss: 0.2309 - val_accuracy: 0.8984
Epoch 19/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1132 - accuracy: 0.9534 - val_loss: 0.0681 - val_accuracy: 0.9795
Epoch 20/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1008 - accuracy: 0.9622 - val_loss: 0.2618 - val_accuracy: 0.8896
Epoch 21/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0872 - accuracy: 0.9690 - val_loss: 0.0740 - val_accuracy: 0.9736
Epoch 22/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0797 - accuracy: 0.9695 - val_loss: 0.0701 - val_accuracy: 0.9727
Epoch 23/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0836 - accuracy: 0.9675 - val_loss: 0.0665 - val_accuracy: 0.9746
Epoch 24/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0820 - accuracy: 0.9670 - val_loss: 0.0514 - val_accuracy: 0.9814
Epoch 25/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0711 - accuracy: 0.9736 - val_loss: 0.0808 - val_accuracy: 0.9678
Epoch 26/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0694 - accuracy: 0.9756 - val_loss: 0.1318 - val_accuracy: 0.9424
Epoch 27/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0589 - accuracy: 0.9795 - val_loss: 0.1254 - val_accuracy: 0.9473
Epoch 28/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0918 - accuracy: 0.9646 - val_loss: 0.0447 - val_accuracy: 0.9844
Epoch 29/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0853 - accuracy: 0.9673 - val_loss: 0.0431 - val_accuracy: 0.9863
Epoch 30/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0472 - accuracy: 0.9844 - val_loss: 0.0602 - val_accuracy: 0.9805
Epoch 31/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0512 - accuracy: 0.9807 - val_loss: 0.0933 - val_accuracy: 0.9609
Epoch 32/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0602 - accuracy: 0.9802 - val_loss: 0.0462 - val_accuracy: 0.9834
Epoch 33/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0593 - accuracy: 0.9761 - val_loss: 0.0399 - val_accuracy: 0.9854
Epoch 34/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0577 - accuracy: 0.9780 - val_loss: 0.1047 - val_accuracy: 0.9609
Epoch 35/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0522 - accuracy: 0.9775 - val_loss: 0.0922 - val_accuracy: 0.9658
Epoch 36/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0581 - accuracy: 0.9758 - val_loss: 0.0360 - val_accuracy: 0.9873
Epoch 37/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0373 - accuracy: 0.9858 - val_loss: 0.0330 - val_accuracy: 0.9902
Epoch 38/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0635 - accuracy: 0.9763 - val_loss: 0.0533 - val_accuracy: 0.9824
Epoch 39/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0583 - accuracy: 0.9761 - val_loss: 0.0473 - val_accuracy: 0.9844
Epoch 40/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0461 - accuracy: 0.9839 - val_loss: 0.0567 - val_accuracy: 0.9824
Epoch 41/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0455 - accuracy: 0.9858 - val_loss: 0.1484 - val_accuracy: 0.9365
Epoch 42/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0877 - accuracy: 0.9648 - val_loss: 0.0550 - val_accuracy: 0.9785
Epoch 43/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0404 - accuracy: 0.9849 - val_loss: 0.0470 - val_accuracy: 0.9844
Epoch 44/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0489 - accuracy: 0.9812 - val_loss: 0.0440 - val_accuracy: 0.9844
Epoch 45/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0327 - accuracy: 0.9890 - val_loss: 0.0541 - val_accuracy: 0.9814
Epoch 46/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0401 - accuracy: 0.9856 - val_loss: 0.0357 - val_accuracy: 0.9873
Epoch 47/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0382 - accuracy: 0.9861 - val_loss: 0.0387 - val_accuracy: 0.9854
Epoch 48/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0515 - accuracy: 0.9795 - val_loss: 0.1669 - val_accuracy: 0.9336
Epoch 49/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0352 - accuracy: 0.9871 - val_loss: 0.0331 - val_accuracy: 0.9873
Epoch 50/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0236 - accuracy: 0.9927 - val_loss: 0.0472 - val_accuracy: 0.9824
Epoch 51/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0576 - accuracy: 0.9800 - val_loss: 0.0381 - val_accuracy: 0.9883
Epoch 52/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0224 - accuracy: 0.9932 - val_loss: 0.1400 - val_accuracy: 0.9424
Epoch 53/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0304 - accuracy: 0.9885 - val_loss: 0.0653 - val_accuracy: 0.9746
Epoch 54/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0368 - accuracy: 0.9854 - val_loss: 0.0934 - val_accuracy: 0.9609
Epoch 55/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0565 - accuracy: 0.9795 - val_loss: 0.0374 - val_accuracy: 0.9883
Epoch 56/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0402 - accuracy: 0.9829 - val_loss: 0.3322 - val_accuracy: 0.8887
Epoch 57/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0345 - accuracy: 0.9873 - val_loss: 0.0491 - val_accuracy: 0.9834
Training for fold 4 - loss: 0.0504 - accuracy: 0.9825
Training for fold 5...
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d_12 (Conv2D)           (None, 28, 28, 16)        8016
_________________________________________________________________
max_pooling2d_12 (MaxPooling (None, 14, 14, 16)        0
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 14, 14, 32)        12832
_________________________________________________________________
max_pooling2d_13 (MaxPooling (None, 7, 7, 32)          0
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 7, 7, 64)          51264
_________________________________________________________________
max_pooling2d_14 (MaxPooling (None, 3, 3, 64)          0
_________________________________________________________________
flatten_4 (Flatten)          (None, 576)               0
_________________________________________________________________
dense_8 (Dense)              (None, 128)               73856
_________________________________________________________________
dense_9 (Dense)              (None, 1)                 129
=================================================================
Total params: 146,097
Trainable params: 146,097
Non-trainable params: 0
_________________________________________________________________

training: 5120 - validation: 1280 - Untrained, accuracy: 52.11%
_________________________________________________________________

Epoch 1/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6935 - accuracy: 0.4922 - val_loss: 0.6931 - val_accuracy: 0.5059
Epoch 2/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6932 - accuracy: 0.4885 - val_loss: 0.6932 - val_accuracy: 0.5078
Epoch 3/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6931 - accuracy: 0.4976 - val_loss: 0.6932 - val_accuracy: 0.5059
Epoch 4/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6932 - accuracy: 0.5059 - val_loss: 0.6931 - val_accuracy: 0.4951
Epoch 5/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6929 - accuracy: 0.5127 - val_loss: 0.6933 - val_accuracy: 0.5059
Epoch 6/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6919 - accuracy: 0.5171 - val_loss: 0.6943 - val_accuracy: 0.4941
Epoch 7/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6881 - accuracy: 0.5627 - val_loss: 0.6813 - val_accuracy: 0.6533
Epoch 8/100
410/410 [==============================] - 4s 9ms/step - loss: 0.6365 - accuracy: 0.6541 - val_loss: 0.5455 - val_accuracy: 0.7578
Epoch 9/100
410/410 [==============================] - 4s 9ms/step - loss: 0.3557 - accuracy: 0.8711 - val_loss: 0.2527 - val_accuracy: 0.9053
Epoch 10/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1745 - accuracy: 0.9390 - val_loss: 0.1473 - val_accuracy: 0.9453
Epoch 11/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1358 - accuracy: 0.9500 - val_loss: 0.1355 - val_accuracy: 0.9473
Epoch 12/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1094 - accuracy: 0.9604 - val_loss: 0.1586 - val_accuracy: 0.9336
Epoch 13/100
410/410 [==============================] - 4s 9ms/step - loss: 0.1139 - accuracy: 0.9600 - val_loss: 0.1080 - val_accuracy: 0.9648
Epoch 14/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0983 - accuracy: 0.9641 - val_loss: 0.1410 - val_accuracy: 0.9434
Epoch 15/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0722 - accuracy: 0.9741 - val_loss: 0.0938 - val_accuracy: 0.9600
Epoch 16/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0854 - accuracy: 0.9661 - val_loss: 0.1646 - val_accuracy: 0.9355
Epoch 17/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0708 - accuracy: 0.9739 - val_loss: 0.0821 - val_accuracy: 0.9688
Epoch 18/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0591 - accuracy: 0.9778 - val_loss: 0.0721 - val_accuracy: 0.9766
Epoch 19/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0734 - accuracy: 0.9722 - val_loss: 0.1773 - val_accuracy: 0.9268
Epoch 20/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0662 - accuracy: 0.9768 - val_loss: 0.1802 - val_accuracy: 0.9277
Epoch 21/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0989 - accuracy: 0.9673 - val_loss: 0.0741 - val_accuracy: 0.9775
Epoch 22/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0598 - accuracy: 0.9783 - val_loss: 0.0745 - val_accuracy: 0.9727
Epoch 23/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0642 - accuracy: 0.9768 - val_loss: 0.0823 - val_accuracy: 0.9736
Epoch 24/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0659 - accuracy: 0.9746 - val_loss: 0.1100 - val_accuracy: 0.9600
Epoch 25/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0453 - accuracy: 0.9849 - val_loss: 0.2917 - val_accuracy: 0.8975
Epoch 26/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0459 - accuracy: 0.9849 - val_loss: 0.1321 - val_accuracy: 0.9473
Epoch 27/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0567 - accuracy: 0.9817 - val_loss: 0.2316 - val_accuracy: 0.9131
Epoch 28/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0390 - accuracy: 0.9851 - val_loss: 0.0665 - val_accuracy: 0.9805
Epoch 29/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0667 - accuracy: 0.9758 - val_loss: 0.0867 - val_accuracy: 0.9707
Epoch 30/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0677 - accuracy: 0.9763 - val_loss: 0.0827 - val_accuracy: 0.9648
Epoch 31/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0665 - accuracy: 0.9756 - val_loss: 0.0710 - val_accuracy: 0.9775
Epoch 32/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0498 - accuracy: 0.9817 - val_loss: 0.1160 - val_accuracy: 0.9502
Epoch 33/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0343 - accuracy: 0.9875 - val_loss: 0.1012 - val_accuracy: 0.9658
Epoch 34/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0445 - accuracy: 0.9854 - val_loss: 0.0613 - val_accuracy: 0.9795
Epoch 35/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0462 - accuracy: 0.9827 - val_loss: 0.1749 - val_accuracy: 0.9375
Epoch 36/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0526 - accuracy: 0.9780 - val_loss: 0.0612 - val_accuracy: 0.9795
Epoch 37/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0731 - accuracy: 0.9705 - val_loss: 0.0831 - val_accuracy: 0.9678
Epoch 38/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0419 - accuracy: 0.9841 - val_loss: 0.0885 - val_accuracy: 0.9727
Epoch 39/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0415 - accuracy: 0.9819 - val_loss: 0.0673 - val_accuracy: 0.9795
Epoch 40/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0332 - accuracy: 0.9897 - val_loss: 0.0807 - val_accuracy: 0.9756
Epoch 41/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0492 - accuracy: 0.9795 - val_loss: 0.0669 - val_accuracy: 0.9775
Epoch 42/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0397 - accuracy: 0.9851 - val_loss: 0.1013 - val_accuracy: 0.9561
Epoch 43/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0379 - accuracy: 0.9868 - val_loss: 0.0679 - val_accuracy: 0.9746
Epoch 44/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0427 - accuracy: 0.9829 - val_loss: 0.0710 - val_accuracy: 0.9814
Epoch 45/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0496 - accuracy: 0.9795 - val_loss: 0.1816 - val_accuracy: 0.9365
Epoch 46/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0398 - accuracy: 0.9851 - val_loss: 0.0679 - val_accuracy: 0.9824
Epoch 47/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0485 - accuracy: 0.9827 - val_loss: 0.0646 - val_accuracy: 0.9775
Epoch 48/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0588 - accuracy: 0.9807 - val_loss: 0.0664 - val_accuracy: 0.9766
Epoch 49/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0293 - accuracy: 0.9905 - val_loss: 0.0713 - val_accuracy: 0.9805
Epoch 50/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0527 - accuracy: 0.9797 - val_loss: 0.0682 - val_accuracy: 0.9775
Epoch 51/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0342 - accuracy: 0.9875 - val_loss: 0.0644 - val_accuracy: 0.9775
Epoch 52/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0244 - accuracy: 0.9910 - val_loss: 0.0682 - val_accuracy: 0.9805
Epoch 53/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0387 - accuracy: 0.9856 - val_loss: 0.0748 - val_accuracy: 0.9785
Epoch 54/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0276 - accuracy: 0.9907 - val_loss: 0.0834 - val_accuracy: 0.9688
Epoch 55/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0421 - accuracy: 0.9839 - val_loss: 0.0829 - val_accuracy: 0.9668
Epoch 56/100
410/410 [==============================] - 4s 9ms/step - loss: 0.0243 - accuracy: 0.9910 - val_loss: 0.0677 - val_accuracy: 0.9795
Training for fold 5 - loss: 0.0439 - accuracy: 0.9812
_________________________________________________________________

avg. loss:     0.1128 (+- 0.0855)
avg. accuracy: 0.9633 (+- 0.0249)
(ML) [haharder@hepp01 code]$
